generator client {
    provider = "prisma-client-js"
}

datasource db {
    provider = "postgresql"
    url      = env("DATABASE_URL")
}

model User {
    id           String       @id
    email        String       @unique
    username     String       @unique
    fullname     String
    blocked      Boolean
    isAdmin      Boolean
    passwordHash String
    collections  Collection[]
    comments     Comment[]
    createdAt    DateTime     @default(now())
    updatedAt    DateTime     @updatedAt

    @@map("user")
}

model Topic {
    id          String       @id
    name        String
    collections Collection[]

    @@map("topic")
}

model Collection {
    owner            User              @relation(fields: [userId], references: [id])
    id               String            @id
    name             String
    topic            Topic             @relation(fields: [topicId], references: [id])
    image            String?
    userId           String
    topicId          String
    collectionFields CollectionField[]
    items            Item[]
    createdAt        DateTime          @default(now())
    updatedAt        DateTime          @updatedAt

    @@map("collection")
}

model CollectionField {
    id           String              @id
    name         String
    collection   Collection          @relation(fields: [collectionId], references: [id])
    type         CollectionFieldType
    collectionId String

    @@map("collection_field")
}

enum CollectionFieldType {
    Number
    Text
    MultilineText
    Checkbox
    Date
}

model Item {
    collection   Collection @relation(fields: [collectionId], references: [id])
    id           String     @id
    name         String
    tags         String[]
    collectionId String
    comments     Comment[]
    createdAt    DateTime   @default(now())
    updatedAt    DateTime   @updatedAt

    @@map("item")
}

model Comment {
    item      Item     @relation(fields: [itemId], references: [id])
    id        String   @id
    author    User     @relation(fields: [userId], references: [id])
    text      String
    itemId    String
    userId    String
    createdAt DateTime
    updatedAt DateTime @updatedAt

    @@map("comment")
}
